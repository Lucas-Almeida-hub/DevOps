pipeline{
    agent any
        stages{
            stage("baixar arquivos"){
                steps {
                   git branch: 'DevOps', url: 'https://github.com/Lucas-Almeida-hub/DevOps.git'
                   sh script : "cp -R ~/workspace/Matrix/* arquivos/"
                }
            }
            stage("Configurando area de build "){
                steps {
                    
 
                    

                    ansiblePlaybook inventory: 'Inventory', playbook: 'Build.yml'
                }
            }
            stage("Enviando imagem para AWS"){
                steps {
                    ansiblePlaybook inventory: 'Inventory', playbook: 'AWS.yml'
                }
            }
            stage("Deploy"){
                steps {
                    sh script : "sudo ansible-playbook Deploy.yml -i Inventory "
                    sh script : "rm dockerfile"
                    sh script : "rm Inventory"
                    sh script : "rm Build.yml"
                    sh script : "rm AWS.yml"
                    sh script : "rm Deploy.yml"
                }
            }
        }
}